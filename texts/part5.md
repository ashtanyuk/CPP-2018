## Перегрузка операций

Одной из важнейших особенностей языка С++ явяется возможность **перегрузки операторов (операций)**.

Вспомним сначала, что такое **перегрузка функций**:

**Перегрузка** - это создание функции с тем же именем, но с отличающимся списком параметров. Иными словами, перегруженные функции называются одинаково, но отличаются количеством или типами своих параметров. Благодаря этому, компилятор их отличает друг от друга в точке вызова.

Перегрузка операций позволяет разработать аналог операции для пользовательского типа в виде функции с определенным набором параметров.

Перегрузка может быть осуществлена

- в виде функции-члена класса (методом)
- в виде глобальной функции (обычной или дружественной классу)

Хороший пример задачи, в которой используется перегрузка: матрицы

```cpp
Matrix a,b,c;
...
c=a+b;
```

Для успешного использования перегрузки, надо знать и соблюдать ряд правил:

- перегружать можно все имеющиеся операции, кроме 
   - ?: - тернарный оператор;
   - :: - доступ к вложенным именам;
   - .  - доступ к полям;
   - .* - доступ к полям по указателю;
   - sizeof, typeid и операторы cast.

- нельзя придумывать свои операции, например @,+++,)( и др.
- при перегрузке нельзя изменять арность операции, ассоциативность, приоритет
- способы перегрузки унарных и бинарных операций отличаются
- хотя бы один из аргументов перегружаемых оператором должен быть пользовательского типа

- следующие операторы можно перегрузить только в качестве методов:
   - = - присваивание;
   - -> - доступ к полям по указателю;
   - () - вызов функции;
   - [] - доступ по индексу;
   - ->* - доступ к указателю-на-поле по указателю;
   - операторы конверсии и управления памятью.

- следующие операторы можно перегрузить только в виде внешних функций:
   - чтение из потока
   - запись в поток
   
### Перегрузка методом класса

#### Бинарные операции

Для перегрузки бинарных операций нужно создать метод, принимающий один аргумент - ссылку на второй аргумент операции.

```cpp
class Complex
{
   private:
     double Re,Im;
   public:
     Complex(double re,double im):Re(re),Im(im) {}
     Complex operator+(const Complex& c) {
        return Complex(Re+c.Re,Im+c.Im);
     }
};
```
Метод, перегружающий операцию сложения, называется **operator+**. Для других операций используются их обозначения.
В результате операции сложения возникает новый объект типа **Complex**.

Перегрузим присваивание:

```cpp
class Complex 
{
  ...
  Complex& operator=(const Complex& c) {
     Re=c.Re;
     Im=c.Im;
     return *this;
  }
  ...
};
```

Теперь можно воспользоваться двумя перегруженными операциями:

```cpp
Complex a(1.1,2.2),b(3.3,4.4),c(0.0,0.0);
c=a+b;
```







